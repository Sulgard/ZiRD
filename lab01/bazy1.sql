--TODO ADD FOREIGN KEYS
CREATE TABLE EMPLOYEES(
	employee_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	first_name VARCHAR(50) NOT NULL,
	last_name VARCHAR(50) NOT NULL,
	email VARCHAR(150) NOT NULL,
	phone_number VARCHAR(20) NOT NULL,
	hire_date DATE NOT NULL,
	job_id NUMBER,
	salary DECIMAL(10, 2) NOT NULL,
	commission_pct NUMBER NOT NULL,
	manager_id NUMBER NOT NULL,
	department_id NUMBER NOT NULL
);


CREATE TABLE REGIONS(
	region_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	region_name VARCHAR(150)
	);

CREATE TABLE COUNTRIES(
	country_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	country_name VARCHAR(250) NOT NULL,
	region_id NUMBER NOT NULL,
	CONSTRAINT fk_regions
	FOREIGN KEY(region_id) REFERENCES REGIONS(region_id)
	);

CREATE TABLE LOCATIONS(
	location_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	street_address VARCHAR(150),
	postal_code VARCHAR(10),
	city VARCHAR(150),
	state_province VARCHAR(150),
	country_id NUMBER,
	CONSTRAINT fk_countries
	FOREIGN KEY(country_id) REFERENCES COUNTRIES(country_id)
	);

CREATE TABLE DEPARTMENTS(
	department_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	department_name VARCHAR(150) NOT NULL,
	manager_id NUMBER NOT NULL,
	location_id NUMBER NOT NULL,
	CONSTRAINT fk_employees
	FOREIGN KEY(manager_id) REFERENCES EMPLOYEES(employee_id),
	CONSTRAINT fk_locations
	FOREIGN KEY(location_id) REFERENCES LOCATIONS(location_id)
	);

CREATE TABLE JOBS(
	job_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	job_title VARCHAR(150) NOT NULL,
	min_salary DECIMAL(10, 2) NOT NULL,
	max_salary DECIMAL(10, 2) NOT NULL,
	CHECK (max_salary - min_salary > 2000)
	);

CREATE TABLE JOB_HISTORY(
	employee_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	start_date DATE NOT NULL,
	end_date DATE NOT NULL,
	job_id NUMBER NOT NULL,
	department_id NUMBER NOT NULL,
	CONSTRAINT fk_jobs,
	FOREIGN KEY(job_id) REFERENCES JOBS(job_id),
	CONSTRAINT fk_departments,
	FOREIGN KEY(department_id) REFERENCES DEPARTMENTS(department_id)
	);

ALTER TABLE EMPLOYEES 
ADD CONSTRAINT fk_department
FOREIGN KEY(department_id) REFERENCES DEPARTMENTS(department_id);

ALTER TABLE EMPLOYEES 
ADD CONSTRAINT fk_manager
FOREIGN KEY(manager_id) REFERENCES EMPLOYEES(employee_id);

